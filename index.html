<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enov Clan Admin Panel</title>
<style>
:root {--bg:#0a0a0a;--card:#111;--accent:#00ffee;--text:#fff;}
body{margin:0;padding:0;font-family:'Poppins',sans-serif;background:var(--bg);color:var(--text);}
header{background:var(--card);padding:1rem;text-align:center;box-shadow:0 0 10px #00ffee40;}
header h1{color:var(--accent);}
main{padding:1rem;}
.card{background:var(--card);padding:1rem;border-radius:12px;margin-bottom:1rem;}
button{background:var(--accent);border:none;color:#000;padding:.5rem 1rem;border-radius:12px;margin:.2rem;cursor:pointer;}
input,select{width:90%;padding:.5rem;margin:.3rem 0;border-radius:8px;border:none;background:#1a1a1a;color:#fff;}
.member{display:flex;justify-content:space-between;padding:.5rem;background:#1a1a1a;margin:.3rem 0;border-radius:8px;font-size:.9rem;}
#notification{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:var(--accent);color:#000;padding:.7rem 1rem;border-radius:12px;display:none;}
</style>

<!-- Firebase (modular SDK) -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getDatabase, ref, onValue, set, get } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyB-RGaKfSNNRRUMLnKMqdZaFjos_Gmcdp8",
  authDomain: "enovclanadmin.firebaseapp.com",
  databaseURL: "https://enovclanadmin-default-rtdb.firebaseio.com",
  projectId: "enovclanadmin",
  storageBucket: "enovclanadmin.appspot.com",
  messagingSenderId: "1234567890",
  appId: "1:1234567890:web:abcdef123456"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Elements
const memberList=document.getElementById("memberList");
const memberSelect=document.getElementById("memberSelect");
const spendSelect=document.getElementById("spendSelect");
const pointsInput=document.getElementById("pointsInput");
const notification=document.getElementById("notification");

let members=[];

// Default members setup
async function initMembers(){
  const snapshot = await get(ref(db, "members"));
  if(!snapshot.exists()){
    const defaults=[
      {name:"Kai",coins:250,level:1,recruits:12},
      {name:"Spaz",coins:250,level:1,recruits:20},
      {name:"Bob",coins:250,level:1,recruits:5}
    ];
    await set(ref(db, "members"), defaults);
  }
}

// Load data and listen for updates
onValue(ref(db,"members"), snap=>{
  if(snap.exists()){
    members=snap.val();
    renderMembers();
  }
});

// Render
function renderMembers(){
  memberList.innerHTML="";
  memberSelect.innerHTML="";
  spendSelect.innerHTML="";
  members.forEach((m,i)=>{
    memberList.innerHTML+=`<div class="member"><span>${m.name} | Lv ${m.level}</span><span>ðŸ’° ${m.coins}</span><span>ðŸŽ¯ ${m.recruits}</span></div>`;
    memberSelect.innerHTML+=`<option value="${i}">${m.name}</option>`;
    spendSelect.innerHTML+=`<option value="${i}">${m.name}</option>`;
  });
}

// Update member
function updateMember(idx){ set(ref(db,"members/"+idx),members[idx]); }

// Notification
function showNotification(msg){
  notification.innerText=msg;
  notification.style.display="block";
  setTimeout(()=>notification.style.display="none",2500);
}

// Add Points
window.addPoints=function(){
  const idx=memberSelect.value;
  const pts=parseInt(pointsInput.value);
  if(isNaN(pts)||pts<=0)return alert("Enter valid points");
  members[idx].coins+=pts;
  updateMember(idx);
  showNotification(`+${pts} coins added to ${members[idx].name}`);
  pointsInput.value="";
};

// Remove Points
window.removePoints=function(){
  const idx=memberSelect.value;
  const pts=parseInt(pointsInput.value);
  if(isNaN(pts)||pts<=0)return alert("Enter valid points");
  if(members[idx].coins>=pts){
    members[idx].coins-=pts;
    updateMember(idx);
    showNotification(`-${pts} coins removed from ${members[idx].name}`);
  } else alert("Not enough coins");
  pointsInput.value="";
};

// Spend Coins
window.spendCoins=function(type){
  const idx=spendSelect.value;
  if(type==="admin" && members[idx].coins>=1000){
    members[idx].coins-=1000; members[idx].level+=1;
    updateMember(idx);
    showNotification(`${members[idx].name} unlocked Admin!`);
  } else if(type==="tournament" && members[idx].coins>=500){
    members[idx].coins-=500;
    updateMember(idx);
    showNotification(`${members[idx].name} is hosting a Tournament!`);
  } else alert("Not enough coins");
};

// Daily coins (every 30 seconds demo)
setInterval(()=>{
  members.forEach(m=>m.coins+=10);
  set(ref(db,"members"),members);
  showNotification("+10 daily coins to all members!");
},30000);

// Start
initMembers();
</script>
</head>

<body>
<header><h1>Enov Clan Admin Panel</h1></header>
<main>
<section>
<h2>Clan Dashboard</h2>
<div class="card" id="memberListCard">
<div id="memberList"></div>
</div>
</section>

<section>
<h2>Admin Tools</h2>
<div class="card">
<select id="memberSelect"></select>
<input type="number" id="pointsInput" placeholder="Points">
<button onclick="addPoints()">Add Points</button>
<button onclick="removePoints()">Remove Points</button>
</div>

<div class="card">
<select id="spendSelect"></select>
<button onclick="spendCoins('admin')">Unlock Admin (1000)</button>
<button onclick="spendCoins('tournament')">Host Tournament (500)</button>
</div>
</section>
</main>
<div id="notification"></div>
</body>
</html>
