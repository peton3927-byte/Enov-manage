<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enov Clan Admin Panel</title>
<style>
:root {--bg:#0a0a0a; --card:#111; --accent:#00ffee; --text:#fff;}
body{margin:0;padding:0;font-family:'Poppins',sans-serif;background:var(--bg);color:var(--text);}
header{background:var(--card);padding:1rem;display:flex;justify-content:center;align-items:center;}
header h1{color:var(--accent);}
main{padding:1rem;}
section{margin-bottom:1rem;}
.card{background:var(--card);padding:1rem;border-radius:12px;margin-bottom:1rem;}
button{background:var(--accent);border:none;color:#000;padding:.5rem 1rem;border-radius:12px;margin:.2rem;cursor:pointer;}
input, select{width:90%;padding:.4rem;margin:.3rem 0;border-radius:8px;border:none;background:#1a1a1a;color:#fff;}
.member{display:flex;justify-content:space-between;padding:.5rem;background:#1a1a1a;margin:.3rem 0;border-radius:8px;font-size:.9rem;}
#notification{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);background:var(--accent);color:#000;padding:.7rem 1rem;border-radius:12px;display:none;}
</style>

<!-- Firebase Scripts -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>

</head>
<body>
<header><h1>Enov Admin Panel</h1></header>

<main>
<section>
<h2>Clan Dashboard</h2>
<div class="card" id="memberListCard">
<div id="memberList"></div>
</div>
</section>

<section>
<h2>Admin Tools</h2>
<div class="card">
<select id="memberSelect"></select>
<input type="number" id="pointsInput" placeholder="Points">
<button id="addBtn">Add Points</button>
<button id="removeBtn">Remove Points</button>
</div>

<div class="card">
<select id="spendSelect"></select>
<button data-type="admin">Unlock Admin (1000)</button>
<button data-type="tournament">Host Tournament (500)</button>
</div>
</section>
</main>

<div id="notification"></div>

<script>
window.onload=function(){
const memberList=document.getElementById("memberList");
const memberSelect=document.getElementById("memberSelect");
const spendSelect=document.getElementById("spendSelect");
const pointsInput=document.getElementById("pointsInput");
const notification=document.getElementById("notification");

// Firebase config
const firebaseConfig = {
apiKey: "AIzaSyB-RGaKfSNNRRUMLnKMqdZaFjos_Gmcdp8",
authDomain: "enovclanadmin.firebaseapp.com",
databaseURL: "https://enovclanadmin.firebaseio.com",
projectId: "enovclanadmin",
storageBucket: "enovclanadmin.appspot.com",
messagingSenderId: "1234567890",
appId: "1:1234567890:web:abcdef123456"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let members = [];
const membersRef = db.ref('members');

// Initialize default members if DB empty
membersRef.once('value', snapshot=>{
  if(!snapshot.exists()){
    const defaultMembers=[
      {name:"Kai",coins:250,level:1,recruits:12},
      {name:"Spaz",coins:250,level:1,recruits:20},
      {name:"Bob",coins:250,level:1,recruits:5}
    ];
    defaultMembers.forEach((m,i)=>membersRef.child(i).set(m));
  }
});

// Listen for changes
membersRef.on('value', snapshot=>{
  members = snapshot.val() || [];
  renderMembers();
});

function renderMembers(){
memberList.innerHTML="";
memberSelect.innerHTML="";
spendSelect.innerHTML="";
members.forEach((m,i)=>{
memberList.innerHTML+=`<div class="member"><span>${m.name} | Lvl ${m.level} | Coins: ${m.coins} | Recruits: ${m.recruits}</span></div>`;
memberSelect.innerHTML+=`<option value="${i}">${m.name}</option>`;
spendSelect.innerHTML+=`<option value="${i}">${m.name}</option>`;
});

}

function showNotification(msg){
notification.innerText=msg;
notification.style.display="block";
setTimeout(()=>notification.style.display="none",2000);
}

function updateMember(idx){
membersRef.child(idx).set(members[idx]);
}

// ADD / REMOVE POINTS
document.getElementById("addBtn").onclick=function(){
let idx=memberSelect.value;
let pts=parseInt(pointsInput.value);
if(isNaN(pts)||pts<=0){alert("Enter valid number");return;}
members[idx].coins+=pts;
updateMember(idx);
showNotification(`+${pts} coins to ${members[idx].name}`);
pointsInput.value="";
};

document.getElementById("removeBtn").onclick=function(){
let idx=memberSelect.value;
let pts=parseInt(pointsInput.value);
if(isNaN(pts)||pts<=0){alert("Enter valid number");return;}
if(members[idx].coins>=pts){
members[idx].coins-=pts;
updateMember(idx);
showNotification(`-${pts} coins from ${members[idx].name}`);
} else alert("Not enough coins");
pointsInput.value="";
};

// SPEND COINS
document.querySelectorAll('button[data-type]').forEach(btn=>{
btn.onclick=function(){
let idx=spendSelect.value;
let type=btn.dataset.type;
if(type==="admin" && members[idx].coins>=1000){
members[idx].coins-=1000; members[idx].level+=1; updateMember(idx);
showNotification(`${members[idx].name} unlocked Admin!`);
} else if(type==="tournament" && members[idx].coins>=500){
members[idx].coins-=500; updateMember(idx);
showNotification(`${members[idx].name} is hosting a tournament!`);
} else alert("Not enough coins");
}
});

};
</script>
</body>
</html>
